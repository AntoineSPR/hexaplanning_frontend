<div class="reset-password-container">
  <p-toast></p-toast>

  <p-card header="Réinitialiser le mot de passe" class="reset-password-card">
    <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="reset-password-form" role="form" aria-label="Formulaire de réinitialisation de mot de passe">
      <div class="form-field">
        <label for="newPassword" class="form-label">Nouveau mot de passe *</label>
        <div class="form-label requirements-list" id="password-requirements">
          (Minimum : 8 caractères, 1 majuscule, 1 minuscule, 1 chiffre, 1 caractère spécial)
        </div>
        <p-password
          formControlName="newPassword"
          [toggleMask]="true"
          placeholder="Entrez votre nouveau mot de passe"
          [class.p-invalid]="hasNewPasswordError"
          [attr.aria-describedby]="'password-requirements' + (hasNewPasswordError ? ' newPassword-error' : '')"
          [attr.aria-invalid]="hasNewPasswordError"
          autocomplete="new-password"
          class="form-input"
          [feedback]="true"
          promptLabel="Entrez un mot de passe"
          weakLabel="Faible"
          mediumLabel="Moyen"
          strongLabel="Fort"></p-password>
        @if (hasNewPasswordError) {
        <small class="p-error" id="newPassword-error" role="alert" aria-live="polite">
          {{ newPasswordError }}
        </small>
        }
      </div>

      <div class="form-field">
        <label for="confirmPassword" class="form-label">Confirmer le nouveau mot de passe *</label>
        <p-password
          formControlName="confirmPassword"
          [toggleMask]="true"
          [feedback]="false"
          placeholder="Confirmez votre nouveau mot de passe"
          [class.p-invalid]="hasConfirmPasswordError"
          [attr.aria-describedby]="hasConfirmPasswordError ? 'confirmPassword-error' : null"
          [attr.aria-invalid]="hasConfirmPasswordError"
          autocomplete="new-password"
          class="form-input"></p-password>
        @if (hasConfirmPasswordError) {
        <small class="p-error" id="confirmPassword-error" role="alert" aria-live="polite">
          {{ confirmPasswordError }}
        </small>
        }
      </div>

      <div class="form-actions">
        <p-button 
          type="submit" 
          label="Réinitialiser le mot de passe" 
          [loading]="isLoading" 
          class="submit-button" 
          [disabled]="isLoading"
          [attr.aria-label]="isLoading ? 'Réinitialisation en cours...' : 'Réinitialiser le mot de passe'"></p-button>
      </div>

      <div class="form-footer">
        <p><a routerLink="/login" class="login-link">Retour à la connexion</a></p>
      </div>
    </form>
  </p-card>
</div>
